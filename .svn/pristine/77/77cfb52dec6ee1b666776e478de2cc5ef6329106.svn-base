function initSettingSearchValue(){function t(t){this.$el=$(t)}function e(t){var e="",i="",a="";e="<a href='./history.html? "+o+"'>全部</a>",f.html(e);for(var n in t.result)t.result.hasOwnProperty(n)&&(i+="<li>"+n+"</li>"),u.html(i);for(var s in t.result)if(t.result.hasOwnProperty(s)){a+='<li class="group"><p class="init '+s+'">'+s+'</p><ul class="list">';for(var r=0,l=t.result[s].length;r<l;r++)a+='<li data-name="'+t.result[s][r].c2+'" ><a href="./history.html?brand='+t.result[s][r].c2+"&"+o+'">'+t.result[s][r].c2+"</a></li>";a+="</ul></li>"}h.html(a)}function i(t){var e="";if(0===t.status){e+="<ul>",e+="<li data-name=全部><a href='./history.html? "+c+"'>全部</a></li></li>";for(var i in t.result)e+="<li data-name="+t.result[i].c4+" ><a href='./history.html?series="+t.result[i].c4+"&"+c+"'>"+t.result[i].c4+"</a></li>";return e+="</ul>"}return 1===t.status?e:2===t.status?e:3===t.status?e="<ul><p>获取数据失败，请重试</p></ul>":void 0}function a(){var t=$(".form-mile"),e="",i="",a="",n=0,s="";t.on("click",".js-button",function(){e=$(this).closest("form").attr("action"),i=$(this).closest("form").attr("name"),a=$("form[name="+i+"]").serializeArray();for(n in a)s+=a[n].name+"="+a[n].value+"&";s=s.substring(0,s.length-1),window.location.href=e+"&"+s})}var n=$(".js-select-brand .js-tt"),s=$(".js-select-series .js-tt"),r=$(".js-select-brand .js-ct"),l=$(".js-select-series .js-ct"),o=$("#brand_param").val(),c=$("#series_param").val(),u=$(".jsl-letter"),h=$(".jsl-brand"),f=($(".jsw-brand"),$(".jsw-series"),$(".jsl-brand-title")),d=new SelectItemValuate({triggerEl:n,targetEl:r}),p=new SelectItemValuate({triggerEl:s,targetEl:l});a(),t.prototype.set=function(t){this.$el.val(t)},t.prototype.get=function(){return this.$el.val()};var m=new t(".js-type-brand"),g=new t(".js-type-series"),v=new t(".js-type-model"),y=getScriptObj(".js-be-api");n.one("click",function(){var t="";$.ajax({url:y.getBrand,type:"GET",dataType:"json",data:{}}).done(function(i){0===i.status&&(t=e(i))}).fail(function(){t="<ul><p>获取品牌失败，请重试</p></ul>"}).always(function(e){r.html(t);var i={};for(var a in e.result)e.result.hasOwnProperty(a)&&(i[a]=h.find("."+a).position().top);~function(){u.on("click","li",function(t){var e=$(this),a=e.text(),n=i[a];h.scrollTop(n)})}()})}),h.on("click","li",function(){g.set(""),v.set(""),s.text("选择车系").removeClass("hint chosen");var t=$(this),e=t.data("name");m.set(e),n.text(e).addClass("chosen"),r.trigger("blur")}),l.on("click","li",function(){v.set(""),$ttModelEl.text("选择型号").removeClass("hint chosen");var t=$(this),e=t.text();g.set(e),s.text(e).addClass("chosen"),l.trigger("blur")}),s.on("click",function(){var t=($(this),m.get()),a="";"品牌选择"===n.text()&&(p.hide(),$.ajax({url:y.getBrand,type:"GET",dataType:"json",data:{}}).done(function(t){0===t.status&&(a=e(t))}).fail(function(){a="<ul><p>获取品牌失败，请重试</p></ul>"}).always(function(t){r.html(a)}),d.show()),$.ajax({url:y.getSeries,type:"GET",dataType:"json",data:{c2:t}}).done(function(t){a=i(t)}).fail(function(){a="<ul><p>获取系列失败，请重试</p></ul>"}).always(function(){l.html(a).scrollTop(0)})})}function historyItemImgLazy(){var t=$(".m-history-item .img img"),e=$(".js-getStyle").text();t.each(function(){var t=$(this);void 0!==t.data("origin")&&t.attr("src",t.data("origin"))}),t.error(function(){var t=$(this);t.attr("src",e+"/prd/img/source/pbl/history-detail-default.png")})}function SelectItemValuate(t){this.triggerEl=t.triggerEl,this.targetEl=t.targetEl,this.showCB=t.showCB,this.hideCB=t.hideCB,this.active=!1,this.eventFn=null,this.init()}$(function(){initSettingSearchValue(),initQuickSale(5),historyItemImgLazy()}),SelectItemValuate.prototype.show=function(){var t=this;$(t.targetEl).addClass("active"),t.active===!1&&(this.eventFn=function(e){var i=0,a=!0,n=$(e.target).parents();for(i=0;i<n.length;i++)if(n[i]===t.targetEl[0]){a=!1;break}a&&t.hide()},setTimeout(function(){$(document).on("click",t.eventFn)},10)),this.active=!0,"function"==typeof t.showCB&&t.showCB()},SelectItemValuate.prototype.hide=function(){var t=this;t.targetEl.removeClass("active"),$(document).off("click",t.eventFn),this.active=!1,"function"==typeof this.hideCB&&this.hideCB()},SelectItemValuate.prototype.init=function(){var t=this;t.triggerEl.on("click",function(){t.active===!1?t.show():t.hide()})};